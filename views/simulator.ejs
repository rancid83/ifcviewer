<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Í±¥Î¨º ÏóêÎÑàÏßÄ Î∂ÑÏÑù ÏãúÎÆ¨Î†àÏù¥ÌÑ∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #000000;
            overflow: hidden;
        }
        
        .header {
            background-color: #000000;
            color: #ffffff;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(255, 255, 255, 0.08);
            border-bottom: 2px solid #1a1a1a;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo {
            font-size: 28px;
            font-weight: 700;
            letter-spacing: 2px;
            display: inline-flex;
            gap: 2px;
            align-items: center;
        }
        
        .logo span {
            /* padding: 2px 4px; */
            -webkit-text-stroke: 1.5px #ffffff;
            text-stroke: 1.5px #ffffff;
            font-weight: 700;
            display: inline-block;
        }
        
        .logo .logo-k {
            color: #1e40af;
            /* dark blue */
        }
        
        .logo .logo-c {
            color: #10b981;
            /* green */
        }
        
        .logo .logo-l {
            color: #1e40af;
            /* dark blue */
        }
        
        .header-title {
            font-size: 20px;
            font-weight: 600;
            color: #ffffff;
            letter-spacing: -0.3px;
        }
        
        .header-right {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        
        .header-right {
            display: flex;
            gap: 0;
            align-items: center;
            border: 1px solid #333333;
            border-radius: 6px;
            overflow: hidden;
        }
        
        .header-btn {
            padding: 10px 20px;
            border: none;
            border-right: 1px solid #333333;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            background-color: transparent;
            color: #ffffff;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .header-btn:last-child {
            border-right: none;
        }
        
        .header-btn:hover {
            background-color: #2a2a2a;
        }
        
        .header-btn:active {
            background-color: #1a1a1a;
        }
        
        .header-btn-icon {
            width: 18px;
            height: 18px;
            flex-shrink: 0;
        }
        
        .header-btn-icon svg {
            width: 100%;
            height: 100%;
            stroke: #ffffff;
            fill: none;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        
        .main-container {
            display: flex;
            height: calc(100vh - 95px);
            gap: 15px;
            padding: 15px;
        }
        
        .panel {
            background-color: #1a1a1a;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(255, 255, 255, 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .panel-left {
            flex: 1;
            min-width: 500px;
        }
        
        .panel-right {
            flex: 1;
            min-width: 500px;
        }
        
        .panel-header {
            background-color: #0a0a0a;
            color: #ffffff;
            padding: 15px 20px;
            font-size: 18px;
            font-weight: 700;
            border-bottom: 2px solid #2a2a2a;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        
        .panel-header .header-title {
            text-align: center;
        }
        
        .panel-header .header-buttons {
            position: absolute;
            right: 20px;
        }
        
        .panel-header .header-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .panel-header .btn {
            padding: 8px 16px;
            font-size: 13px;
            white-space: nowrap;
        }
        
        .panel-content {
            padding: 20px;
            overflow-y: auto;
            flex: 1;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .btn-dark {
            background-color: #34495e;
            color: white;
        }
        
        .btn-dark:hover {
            background-color: #2c3e50;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .btn-primary {
            background-color: #3b82f6;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2563eb;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(59, 130, 246, 0.3);
        }
        
        .btn-gray {
            background-color: #6b7280;
            color: #ffffff;
        }
        
        .btn-gray:hover {
            background-color: #4b5563;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(107, 114, 128, 0.3);
        }
        /* IFC Î∑∞Ïñ¥ ÏÑπÏÖò */
        
        .viewer-section {
            margin-bottom: 20px;
            position: relative;
        }
        
        #viewer-container {
            width: 100%;
            height: 400px;
            background-color: #0a0a0a;
            border-radius: 8px;
            border: 2px solid #333333;
            margin-top: 15px;
            position: relative;
            overflow: hidden;
        }
        
        #viewer-container canvas {
            display: block;
            width: 100%;
            height: 100%;
            border-radius: 8px;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
        }
        /* ÏóêÎÑàÏßÄ Î†àÏ†ÑÎìú Ïä§ÌÉÄÏùº */
        
        #energy-legend {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            padding: 10px 8px;
            background-color: rgba(0, 0, 0, 0.95);
            border-radius: 8px;
            border: 1px solid rgba(50, 50, 50, 0.8);
            box-shadow: 0 2px 8px rgba(255, 255, 255, 0.2);
            z-index: 1000;
            width: 50px;
            height: 300px;
            pointer-events: auto;
        }
        /* ÏóêÎÑàÏßÄ ÏÇ¨Ïö©Îüâ ÌëúÏãú (Î∑∞Ïñ¥ Ïò§Î•∏Ï™Ω ÏÉÅÎã®) */
        
        #energy-display {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 8px 12px;
            background-color: rgba(0, 0, 0, 0.95);
            border-radius: 6px;
            border: 1px solid rgba(50, 50, 50, 0.8);
            box-shadow: 0 2px 6px rgba(255, 255, 255, 0.15);
            z-index: 1000;
            pointer-events: auto;
            font-size: 12px;
            line-height: 1.4;
        }
        
        #energy-display .energy-row {
            display: flex;
            align-items: center;
            margin-bottom: 4px;
            white-space: nowrap;
        }
        
        #energy-display .energy-row:last-child {
            margin-bottom: 0;
        }
        
        #energy-display .energy-label {
            font-weight: 600;
            margin-right: 8px;
            font-size: 11px;
            min-width: 35px;
        }
        
        #energy-display .energy-value {
            font-weight: bold;
            font-size: 13px;
            text-align: left;
            width: 240px;
            /* -0.000009051694178197067 Í∏∏Ïù¥Ïóê ÎßûÏ∂ò Í≥†Ï†ï ÎÑàÎπÑ */
            display: inline-block;
        }
        
        #energy-display .energy-unit {
            font-size: 10px;
            margin-left: 3px;
        }
        /* ÌôïÎåÄ/Ï∂ïÏÜå Î≤ÑÌäº Ïä§ÌÉÄÏùº */
        
        .zoom-controls {
            position: absolute;
            top: 10px;
            left: 70px;
            /* Î†àÏ†ÑÎìú ÏòÜÏóê Î∞∞Ïπò */
            z-index: 1001;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .zoom-btn {
            width: 36px;
            height: 36px;
            border: none;
            border-radius: 6px;
            background-color: rgba(0, 0, 0, 0.9);
            color: #ffffff;
            font-size: 20px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(255, 255, 255, 0.15);
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
            border: 1px solid #333333;
        }
        
        .zoom-btn:hover {
            background-color: #1a1a1a;
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(255, 255, 255, 0.2);
        }
        
        .zoom-btn:active {
            transform: scale(0.95);
        }
        /* ÏãúÍ∞ÑÎ≥Ñ ÏÇ¨Ïö©Îüâ Î≥¥Í∏∞ ÏÑπÏÖò */
        
        .time-usage-section {
            background-color: #0a0a0a;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #333333;
        }
        
        .time-usage-section h3 {
            margin-bottom: 15px;
            color: #ffffff;
            font-size: 16px;
        }
        
        .season-toggle {
            display: inline-flex;
            background-color: #1a1a1a;
            border-radius: 8px;
            padding: 4px;
            border: 1px solid #333333;
        }
        
        .season-btn {
            padding: 10px 40px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s;
            background-color: transparent;
            color: #9ca3af;
        }
        
        .season-btn.active {
            background-color: #2a2a2a;
            color: #ffffff;
            box-shadow: 0 2px 4px rgba(255, 255, 255, 0.1);
        }
        
        .control-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .play-btn {
            background-color: #10b981;
            color: white;
        }
        
        .play-btn:hover:not(:disabled) {
            background-color: #059669;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(16, 185, 129, 0.3);
        }
        
        .pause-btn {
            background-color: #f59e0b;
            color: white;
        }
        
        .pause-btn:hover:not(:disabled) {
            background-color: #d97706;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(245, 158, 11, 0.3);
        }
        
        .speed-select {
            padding: 8px 12px;
            border: 2px solid #333333;
            border-radius: 6px;
            background-color: #2a2a2a;
            color: #ffffff;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .speed-select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }
        
        .time-slider-container {
            margin-bottom: 20px;
        }
        
        .time-slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            outline: none;
            background: #333333;
            -webkit-appearance: none;
        }
        
        .time-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .time-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .time-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 12px;
            color: #9ca3af;
            font-weight: 600;
        }
        
        .date-selector {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .date-input-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .date-input-group label {
            font-size: 12px;
            color: #7f8c8d;
            font-weight: 600;
        }
        
        .date-input-group input {
            width: 80px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        /* Controller Îã§Ïù¥Ïñ¥Í∑∏Îû® ÏÑπÏÖò */
        
        .controller-section {
            margin-bottom: 20px;
        }
        
        .controller-diagram {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            margin-top: 15px;
        }
        
        .diagram-title {
            text-align: center;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 16px;
        }
        
        .diagram-image-container {
            width: 100%;
            height: 400px;
            background-color: #0a0a0a;
            border-radius: 8px;
            border: 2px solid #333333;
            display: flex;
            align-items: stretch;
            overflow: hidden;
            position: relative;
        }
        
        .diagram-image {
            flex: 0 0 75%;
            height: 100%;
            object-fit: contain;
            display: block;
        }
        /* Tree Menu Styles */
        
        .tree-menu {
            flex: 0 0 25%;
            background-color: #494949;
            border-right: 2px solid #333333;
            padding: 15px;
            overflow-y: auto;
            color: #ffffff;
            font-size: 14px;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .tree-menu-item {
            margin-bottom: 5px;
        }
        
        .tree-menu-toggle {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 3px;
            border-radius: 4px;
            transition: background-color 0.2s;
            user-select: none;
        }
        
        .tree-menu-toggle:hover {
            background-color: #2a2a2a;
        }
        
        .tree-menu-icon {
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 8px;
            font-size: 12px;
            font-weight: bold;
            color: #9ca3af;
            flex-shrink: 0;
        }
        
        .tree-menu-label {
            flex: 1;
            font-weight: 500;
        }
        
        .tree-menu-children {
            margin-left: 26px;
            margin-top: 5px;
            display: none;
        }
        
        .tree-menu-item.expanded>.tree-menu-children {
            display: block;
        }
        
        .tree-menu-item.expanded>.tree-menu-toggle>.tree-menu-icon::before {
            content: '‚àí';
        }
        
        .tree-menu-item:not(.expanded)>.tree-menu-toggle>.tree-menu-icon::before {
            content: '+';
        }
        
        .tree-menu-item.leaf>.tree-menu-toggle>.tree-menu-icon {
            width: 18px;
            margin-right: 8px;
        }
        
        .tree-menu-item.leaf>.tree-menu-toggle>.tree-menu-icon::before {
            content: '‚Ä¢';
            color: #6b7280;
        }
        /* ÏãúÎÆ¨Î†àÏù¥ÏÖò ÏÑ§Ï†ï ÏÑπÏÖò */
        
        .simulation-settings {
            background-color: #000000;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #333333;
        }
        
        .simulation-settings h3 {
            margin-bottom: 15px;
            color: #ffffff;
            font-size: 16px;
            font-weight: 600;
        }
        /* ÌååÎùºÎØ∏ÌÑ∞ Ï†ïÎ≥¥ Î∞î */
        
        .simulation-params-bar {
            background-color: #2a2a2a;
            padding: 10px 15px;
            border-radius: 6px;
            margin-bottom: 15px;
            font-size: 12px;
            color: #ffffff;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .params-pin-icon {
            color: #ff0000;
            font-size: 14px;
        }
        
        .settings-table {
            width: 100%;
            border-collapse: collapse;
            background-color: #000000;
        }
        
        .settings-table th {
            background-color: #000000;
            color: #ffffff;
            padding: 10px;
            text-align: center;
            font-size: 12px;
            font-weight: 700;
            border-bottom: 2px solid #333333;
        }
        
        .settings-table td {
            padding: 10px;
            border-bottom: 1px solid #333333;
            text-align: center;
            background-color: #000000;
        }
        
        .settings-table tr:last-child td {
            border-bottom: none;
        }
        
        .param-label {
            font-size: 11px;
            color: #7f8c8d;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .param-input {
            width: 100%;
            padding: 8px 6px;
            border: 1px solid #333333;
            border-radius: 4px;
            font-size: 13px;
            text-align: center;
            background-color: #2a2a2a;
            color: #ffffff;
        }
        
        .param-input[type="number"] {
            padding: 6px;
        }
        
        select.param-input {
            padding: 6px 8px;
            text-align: center;
            text-align-last: center;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23333' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 8px center;
            padding-right: 28px;
        }
        
        .case-select {
            width: 100%;
            padding: 8px;
            border: 2px solid #3b82f6;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 600;
            color: #60a5fa;
            background-color: #1a2332;
            cursor: pointer;
        }
        
        .case-select:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }
        
        .param-value {
            width: 100%;
            padding: 6px;
            background-color: #1a1a1a;
            border: 1px solid #333333;
            border-radius: 4px;
            font-size: 13px;
            text-align: center;
            color: #ffffff;
            min-height: 24px;
        }
        
        .cell-row-label {
            font-weight: 600;
            color: #ffffff;
            font-size: 13px;
        }
        /* Î∞òÏùëÌòï */
        
        @media (max-width: 1200px) {
            .main-container {
                flex-direction: column;
            }
            .panel-left,
            .panel-right {
                min-width: 100%;
            }
            #viewer-container {
                height: 300px;
            }
            .diagram-image-container {
                height: 300px;
            }
        }
        /* BIM Îç∞Ïù¥ÌÑ∞ Ï∂îÏ∂ú ÌåùÏóÖ Ïä§ÌÉÄÏùº */
        
        .bim-extract-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        
        .bim-extract-popup-overlay.show {
            display: flex;
        }
        
        .bim-extract-popup {
            background-color: #2a2a2a;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            min-width: 500px;
            max-width: 600px;
            overflow: hidden;
        }
        
        .bim-extract-popup-header {
            background-color: #ffffff;
            color: #000000;
            padding: 12px 20px;
            font-size: 14px;
            font-weight: 600;
            text-align: center;
        }
        
        .bim-extract-popup-content {
            padding: 20px;
            display: flex;
            align-items: flex-start;
            gap: 20px;
        }
        
        .bim-extract-popup-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: #fbbf24;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 32px;
            font-weight: bold;
            color: #000000;
        }
        
        .bim-extract-popup-message {
            flex: 1;
            color: #ffffff;
            font-size: 16px;
            font-weight: 500;
            line-height: 3.5;
        }
        
        .bim-extract-progress {
            margin-top: 30px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            position: relative;
            padding: 0 20px;
        }
        
        .bim-extract-progress::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 50px;
            right: 50px;
            height: 2px;
            background-color: #ffffff;
            z-index: 1;
        }
        
        .bim-extract-progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
        }
        
        .bim-extract-progress-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #2a2a2a;
            border: 2px solid #ffffff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
            color: #ffffff;
            margin-bottom: 10px;
            transition: all 0.3s;
        }
        
        .bim-extract-progress-circle.completed {
            background-color: #10b981;
            border-color: #10b981;
        }
        
        .bim-extract-progress-circle.completed::after {
            content: '‚úì';
            color: #ffffff;
        }
        
        .bim-extract-progress-label {
            color: #ffffff;
            font-size: 13px;
            font-weight: 500;
            text-align: center;
        }
        
        .bim-extract-popup-footer {
            padding: 20px 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            border-top: 1px solid #333333;
        }
        
        .bim-extract-popup-badge {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: #ef4444;
            color: #ffffff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .bim-extract-popup-confirm-btn {
            padding: 10px 30px;
            border: 1px solid #ffffff;
            border-radius: 6px;
            background-color: transparent;
            color: #ffffff;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .bim-extract-popup-confirm-btn:hover {
            background-color: #ffffff;
            color: #2a2a2a;
        }
        
        .bim-extract-popup-confirm-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        /* ÏãúÎÆ¨Î†àÏù¥ÏÖò Îß§ÎãàÏ†Ä ÌåùÏóÖ Ïä§ÌÉÄÏùº */
        
        .simulation-manager-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: flex-start;
            align-items: center;
            z-index: 10001;
            padding: 15px;
            padding-left: 180px;
        }
        
        .simulation-manager-popup-overlay.show {
            display: flex;
        }
        
        .simulation-manager-popup {
            background-color: #2a2a2a;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            min-width: 600px;
            max-width: 700px;
            overflow: hidden;
            border: 1px solid #555555;
        }
        
        .simulation-manager-popup-warning {
            background-color: #ffffff;
            color: #000000;
            padding: 12px 20px;
            font-size: 14px;
            font-weight: 600;
            text-align: center;
            border-bottom: 1px solid #cccccc;
        }
        
        .simulation-manager-popup-header {
            background-color: #ffffff;
            color: #000000;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: 600;
            text-align: left;
            position: relative;
            border-bottom: 1px solid #cccccc;
        }
        
        .simulation-manager-popup-title {
            color: #000000;
        }
        
        .simulation-manager-popup-buttons {
            position: absolute;
            top: 8px;
            right: 20px;
            display: flex;
            gap: 8px;
        }
        
        .simulation-manager-popup-btn {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 6px;
            background-color: #e0e0e0;
            color: #000000;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .simulation-manager-popup-btn:hover {
            background-color: #d0d0d0;
        }
        
        .simulation-manager-popup-btn:active {
            background-color: #c0c0c0;
        }
        
        .simulation-manager-popup-content {
            padding: 40px;
        }
        
        .simulation-manager-form-group {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .simulation-manager-label {
            color: #ffffff;
            font-size: 15px;
            font-weight: 600;
            min-width: 120px;
        }
        
        .simulation-manager-select {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid #333333;
            border-radius: 6px;
            background-color: #1a1a1a;
            color: #ffffff;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .simulation-manager-select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }
        
        .simulation-manager-select option {
            background-color: #2a2a2a;
            color: #ffffff;
        }
        /* Schedule ÌåùÏóÖ Ïä§ÌÉÄÏùº */
        
        .schedule-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: flex-start;
            align-items: center;
            z-index: 10001;
            padding: 15px;
            padding-left: 180px;
        }
        
        .schedule-popup-overlay.show {
            display: flex;
        }
        
        .schedule-popup {
            background-color: #2a2a2a;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            min-width: 500px;
            max-width: 600px;
            overflow: hidden;
            border: 1px solid #555555;
        }
        
        .schedule-popup-header {
            background-color: #ffffff;
            color: #000000;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: 600;
            text-align: left;
            position: relative;
            border-bottom: 1px solid #cccccc;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .schedule-popup-icon {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .schedule-popup-title {
            flex: 1;
            color: #000000;
        }
        
        .schedule-popup-buttons {
            position: absolute;
            top: 8px;
            right: 20px;
            display: flex;
            gap: 8px;
        }
        
        .schedule-popup-btn {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 6px;
            background-color: #e0e0e0;
            color: #000000;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .schedule-popup-btn:hover {
            background-color: #d0d0d0;
        }
        
        .schedule-popup-btn:active {
            background-color: #c0c0c0;
        }
        
        .schedule-popup-content {
            padding: 30px 40px;
        }
        
        .schedule-zone-section {
            margin-bottom: 30px;
        }
        
        .schedule-zone-section:last-child {
            margin-bottom: 0;
        }
        
        .schedule-zone-title {
            color: #ffffff;
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 15px;
            text-decoration: underline;
        }
        
        .schedule-form-group {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .schedule-label {
            color: #ffffff;
            font-size: 15px;
            font-weight: 500;
            min-width: 140px;
        }
        
        .schedule-select-wrapper {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .schedule-select {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid #333333;
            border-radius: 6px;
            background-color: #1a1a1a;
            color: #ffffff;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .schedule-select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }
        
        .schedule-select option {
            background-color: #2a2a2a;
            color: #ffffff;
        }
        
        .schedule-edit-icon {
            width: 20px;
            height: 20px;
            cursor: pointer;
            color: #9ca3af;
            transition: color 0.2s;
        }
        
        .schedule-edit-icon:hover {
            color: #ffffff;
        }
        
        .schedule-divider {
            height: 1px;
            background-color: #555555;
            margin: 20px 0;
        }
        /* Zone Ï†ïÎ≥¥ ÌåùÏóÖ Ïä§ÌÉÄÏùº */
        
        .zone-info-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: flex-start;
            align-items: flex-start;
            z-index: 10002;
            padding: 15px;
            padding-left: 180px;
            padding-top: 80px;
        }
        
        .zone-info-popup-overlay.show {
            display: flex;
        }
        
        .zone-info-popup {
            background-color: #2a2a2a;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            min-width: 750px;
            max-width: 900px;
            width: 800px;
            overflow: hidden;
            border: 1px solid #555555;
        }
        
        .zone-info-popup-header {
            background-color: #ffffff;
            color: #000000;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: 600;
            text-align: left;
            position: relative;
            border-bottom: 1px solid #cccccc;
        }
        
        .zone-info-popup-title {
            color: #000000;
        }
        
        .zone-info-popup-buttons {
            position: absolute;
            top: 8px;
            right: 20px;
            display: flex;
            gap: 8px;
        }
        
        .zone-info-popup-btn {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 6px;
            background-color: #e0e0e0;
            color: #000000;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .zone-info-popup-btn:hover {
            background-color: #d0d0d0;
        }
        
        .zone-info-popup-content {
            padding: 30px 40px;
            display: flex;
            gap: 30px;
            align-items: flex-start;
        }
        
        .zone-info-section {
            flex: 1;
            min-width: 300px;
        }
        
        .zone-info-section-title {
            color: #ffffff;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .zone-info-field {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .zone-info-field:last-child {
            margin-bottom: 0;
        }
        
        .zone-info-field-label {
            color: #ffffff;
            font-size: 15px;
            font-weight: 500;
        }
        
        .zone-info-field-value {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .zone-info-field-input {
            padding: 8px 12px;
            border: 1px solid #333333;
            border-radius: 6px;
            background-color: #1a1a1a;
            color: #ffffff;
            font-size: 15px;
            width: 120px;
            text-align: right;
        }
        
        .zone-info-field-unit {
            color: #9ca3af;
            font-size: 14px;
        }
        
        .zone-info-menu-group {
            flex: 1;
            min-width: 350px;
            padding-left: 30px;
            border-left: 1px solid #555555;
        }
        
        .zone-info-menu-title {
            color: #ffffff;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .zone-info-menu-container {
            display: flex;
            gap: 20px;
            align-items: flex-start;
        }
        
        .zone-info-menu-left {
            flex: 1;
        }
        
        .zone-info-menu-right {
            flex: 1;
            padding-left: 20px;
            border-left: 1px solid #555555;
        }
        
        .zone-info-menu-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px 15px;
            margin-bottom: 8px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            background-color: #1a1a1a;
            border: 1px solid #333333;
        }
        
        .zone-info-menu-item:hover {
            background-color: #2a2a2a;
            border-color: #444444;
        }
        
        .zone-info-menu-item.active {
            background-color: #1e3a5f;
            border-color: #3b82f6;
        }
        
        .zone-info-menu-item.disabled {
            opacity: 0.5;
            cursor: pointer;
        }
        
        .zone-info-menu-item.disabled .zone-info-menu-icon {
            opacity: 1;
            filter: grayscale(100%) brightness(0.6);
        }
        
        .zone-info-menu-item.disabled .zone-info-menu-label {
            color: #888888;
        }
        
        .zone-info-menu-icon {
            font-size: 24px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: all 0.3s;
            position: relative;
        }
        
        .zone-info-menu-icon .icon-overlay {
            position: absolute;
            display: inline-block;
            transition: transform 0.2s ease;
        }
        
        .zone-info-menu-icon .icon-sun,
        .zone-info-menu-icon .icon-snow {
            font-size: 20px;
            z-index: 1;
            transform: translateY(-4px);
        }
        
        .zone-info-menu-icon .icon-temp {
            font-size: 20px;
            z-index: 2;
            transform: translateY(4px);
        }
        
        .zone-info-menu-item.active .zone-info-menu-icon {
            opacity: 1;
            filter: brightness(1.2);
        }
        
        .zone-info-menu-label {
            color: #ffffff;
            font-size: 15px;
            font-weight: 500;
            flex: 1;
        }
        
        .zone-info-divider {
            height: 1px;
            background-color: #555555;
            margin: 25px 0;
        }
        /* Type Manager ÌåùÏóÖ Ïä§ÌÉÄÏùº (Heating, Cooling, Gain/losses, Ventilation Í≥µÌÜµ) */
        
        .type-manager-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: flex-start;
            align-items: flex-start;
            z-index: 10003;
            padding: 15px;
            padding-left: 180px;
            padding-top: 350px;
        }
        
        .type-manager-popup-overlay.show {
            display: flex;
        }
        
        .type-manager-popup {
            background-color: #2a2a2a;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            min-width: 750px;
            max-width: 900px;
            width: 800px;
            overflow: hidden;
            border: 1px solid #555555;
        }
        
        .type-manager-popup-header {
            background-color: #ffffff;
            color: #000000;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: 600;
            text-align: left;
            position: relative;
            border-bottom: 1px solid #cccccc;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .type-manager-popup-icon {
            font-size: 24px;
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
        }
        
        .icon-overlay {
            position: absolute;
            display: inline-block;
            transition: transform 0.2s ease;
        }
        
        .icon-sun,
        .icon-snow {
            font-size: 20px;
            z-index: 1;
            transform: translateY(-4px);
        }
        
        .icon-temp {
            font-size: 20px;
            z-index: 2;
            transform: translateY(4px);
        }
        
        .type-manager-popup-title {
            flex: 1;
            color: #000000;
        }
        
        .type-manager-popup-buttons {
            position: absolute;
            top: 8px;
            right: 20px;
            display: flex;
            gap: 8px;
        }
        
        .type-manager-popup-btn {
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 6px;
            background-color: #e0e0e0;
            color: #000000;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .type-manager-popup-btn:hover {
            background-color: #d0d0d0;
        }
        
        .type-manager-popup-content {
            padding: 30px 40px;
        }
        
        .type-manager-section-title {
            color: #ffffff;
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .type-manager-section-subtitle {
            color: #9ca3af;
            font-size: 13px;
            margin-bottom: 20px;
        }
        
        .type-manager-form-group {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .type-manager-label {
            color: #ffffff;
            font-size: 15px;
            font-weight: 500;
        }
        
        .type-manager-select-wrapper {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .type-manager-select {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid #333333;
            border-radius: 6px;
            background-color: #1a1a1a;
            color: #ffffff;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .type-manager-select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }
        
        .type-manager-select option {
            background-color: #2a2a2a;
            color: #ffffff;
        }
        
        .type-manager-unit {
            color: #9ca3af;
            font-size: 14px;
        }
        
        .type-manager-edit-icon {
            width: 20px;
            height: 20px;
            cursor: pointer;
            color: #9ca3af;
            transition: color 0.2s;
        }
        
        .type-manager-edit-icon:hover {
            color: #ffffff;
        }
        
        .type-manager-subsection {
            margin-bottom: 20px;
        }
        
        .type-manager-subsection:last-of-type {
            margin-bottom: 0;
        }
        
        .type-manager-divider {
            height: 1px;
            background-color: #555555;
            margin: 25px 0;
        }
    </style>
</head>

<body>
    <div class="header">
        <div class="header-left">
            <div class="logo">
                <span class="logo-k">K</span>
                <span class="logo-c">C</span>
                <span class="logo-l">L</span>
            </div>
            <div class="header-title">T-Lab Digital Twin System</div>
        </div>
        <div class="header-right">
            <button class="header-btn" id="header-load-bim-btn">
                <span class="header-btn-icon">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                        <polyline points="14 2 14 8 20 8"/>
                        <line x1="16" y1="13" x2="8" y2="13"/>
                        <line x1="16" y1="17" x2="8" y2="17"/>
                        <polyline points="10 9 9 9 8 9"/>
                        <path d="M12 5l2 2 4-4"/>
                    </svg>
                </span>
                <span>BIM Î∂àÎü¨Ïò§Í∏∞</span>
            </button>
            <button class="header-btn" id="header-extract-bim-btn">
                <span class="header-btn-icon">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                        <rect x="3" y="3" width="4" height="4" rx="1"/>
                        <rect x="8" y="3" width="4" height="4" rx="1"/>
                        <rect x="13" y="3" width="4" height="4" rx="1"/>
                        <rect x="17" y="3" width="4" height="4" rx="1"/>
                    </svg>
                </span>
                <span>BIM Îç∞Ïù¥ÌÑ∞ Ï∂îÏ∂ú</span>
            </button>
            <button class="header-btn" id="header-select-sim-btn">
                <span class="header-btn-icon">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
                        <line x1="8" y1="21" x2="16" y2="21"/>
                        <line x1="12" y1="17" x2="12" y2="21"/>
                        <rect x="9" y="7" width="6" height="6" rx="0.5"/>
                        <path d="M9 7l3-3 3 3"/>
                        <line x1="12" y1="4" x2="12" y2="7"/>
                    </svg>
                </span>
                <span>ÏãúÎÆ¨Î†àÏù¥ÏÖò ÏÑ†ÌÉù</span>
            </button>
        </div>
    </div>

    <div class="main-container">
        <!-- Ï¢åÏ∏° Ìå®ÎÑê: Î∂ÑÏÑù Í≤∞Í≥º Î≥¥Í∏∞ -->
        <div class="panel panel-left">
            <div class="panel-header">
                <span class="header-title">Building Information Model</span>
                <div class="header-buttons" style="display: none;">
                    <button class="btn btn-dark" id="load-ifc-btn">
                        üìÇ ÌååÏùº Î∂àÎü¨Ïò§Í∏∞ (IFC)
                    </button>
                </div>
            </div>
            <div class="panel-content">
                <!-- IFC ÌååÏùº Î∂àÎü¨Ïò§Í∏∞ -->
                <div class="viewer-section">
                    <input type="file" id="ifc-file-input" accept=".ifc" style="display: none;">

                    <!-- IFC Î∑∞Ïñ¥ -->
                    <div id="viewer-container">
                        <!-- ÌôïÎåÄ/Ï∂ïÏÜå Î≤ÑÌäº -->
                        <div class="zoom-controls">
                            <button id="zoom-in-btn" class="zoom-btn" title="ÌôïÎåÄ">+</button>
                            <button id="zoom-out-btn" class="zoom-btn" title="Ï∂ïÏÜå">‚àí</button>
                        </div>
                    </div>
                    <!-- ÏóêÎÑàÏßÄ ÏÇ¨Ïö©Îüâ Ïª¨Îü¨ Î†àÏ†ÑÎìú (Î∑∞Ïñ¥ ÏúÑÏóê Ïò§Î≤ÑÎ†àÏù¥) -->
                    <div id="energy-legend"></div>
                    <!-- ÏóêÎÑàÏßÄ ÏÇ¨Ïö©Îüâ ÌëúÏãú (Î∑∞Ïñ¥ Ïò§Î•∏Ï™Ω ÏÉÅÎã®) -->
                    <div id="energy-display">
                        <div class="energy-row">
                            <span class="energy-label" style="color: #e74c3c;">Test:</span>
                            <span id="test-energy" class="energy-value" style="color: #e74c3c; text-align: left;">0</span>
                            <span class="energy-unit" style="color: #e74c3c;">kJ/h</span>
                        </div>
                        <div class="energy-row">
                            <span class="energy-label" style="color: #3498db;">Ref:</span>
                            <span id="ref-energy" class="energy-value" style="color: #3498db; text-align: left;">0</span>
                            <span class="energy-unit" style="color: #3498db;">kJ/h</span>
                        </div>
                        <div class="energy-row">
                            <span class="energy-label">Ï∞®Ïù¥:</span>
                            <span id="energy-diff" class="energy-value" style="text-align: left;">0</span>
                            <span id="energy-diff-percent" class="energy-unit" style="color: #7f8c8d;">(0%)</span>
                        </div>
                    </div>
                </div>

                <!-- ÏãúÍ∞ÑÎ≥Ñ ÏÇ¨Ïö©Îüâ Î≥¥Í∏∞ -->
                <div class="time-usage-section">
                    <h3>‚è∞ ÏãúÍ∞ÑÎ≥Ñ ÏÇ¨Ïö©Îüâ Î≥¥Í∏∞</h3>

                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;">
                        <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                            <!-- Ïó¨Î¶Ñ/Í≤®Ïö∏ ÌÜ†Í∏Ä -->
                            <div class="season-toggle">
                                <button class="season-btn active" data-season="summer">Ïó¨Î¶Ñ</button>
                                <button class="season-btn" data-season="winter">Í≤®Ïö∏</button>
                            </div>

                            <!-- ÎÇ†Ïßú ÏÑ†ÌÉù -->
                            <div style="display: flex; gap: 8px; align-items: center;">
                                <label style="font-size: 14px; color: #ffffff; font-weight: 600;">ÎÇ†Ïßú:</label>
                                <select id="year-select" class="date-select" style="padding: 8px; border: 1px solid #333333; border-radius: 6px; font-size: 14px; background-color: #2a2a2a; color: #ffffff;">
                                    <option value="2025">2025ÎÖÑ</option>
                                </select>
                                <select id="month-select" class="date-select" style="padding: 8px; border: 1px solid #333333; border-radius: 6px; font-size: 14px; background-color: #2a2a2a; color: #ffffff;">
                                    <!-- JavaScriptÎ°ú ÎèôÏ†Å ÏÉùÏÑ± -->
                                </select>
                                <select id="day-select" class="date-select" style="padding: 8px; border: 1px solid #333333; border-radius: 6px; font-size: 14px; background-color: #2a2a2a; color: #ffffff;">
                                    <!-- JavaScriptÎ°ú ÎèôÏ†Å ÏÉùÏÑ± -->
                                </select>
                            </div>
                        </div>

                        <!-- Ïû¨ÏÉù Ïª®Ìä∏Î°§ -->
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <button id="play-btn" class="control-btn play-btn">
                                ‚ñ∂ Ïû¨ÏÉù
                            </button>
                            <button id="pause-btn" class="control-btn pause-btn" disabled>
                                ‚è∏ Ï†ïÏßÄ
                            </button>
                            <select id="speed-select" class="speed-select">
                                <option value="1">1x</option>
                                <option value="2">2x</option>
                                <option value="5">5x</option>
                                <option value="10" selected>10x</option>
                                <option value="30">30x</option>
                                <option value="60">60x</option>
                                <option value="120">120x</option>
                                <option value="200">200x</option>
                                <option value="300">300x</option>
                            </select>
                        </div>
                    </div>

                    <!-- Ï†ÑÏ≤¥ Í∏∞Í∞Ñ Ïä¨ÎùºÏù¥Îçî -->
                    <div class="time-slider-container">
                        <h4 style="margin-bottom: 10px; color: #ffffff; font-size: 14px;">üìÖ ÏùºÎ≥Ñ</h4>
                        <input type="range" class="time-slider" id="time-slider" min="0" max="83520" value="0" step="1">
                        <div class="time-labels">
                            <span id="current-date-display" style="color: #60a5fa; font-weight: 600;">2025-08-01</span>
                            <span id="current-time-display">00:00</span>
                            <span id="current-minute-display">ÌîÑÎ†àÏûÑ: 0</span>
                        </div>
                    </div>

                    <!-- ÏùºÎ≥Ñ ÏãúÍ∞ÑÎåÄ Ïä¨ÎùºÏù¥Îçî (Ïã†Í∑ú) -->
                    <div class="time-slider-container" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #333333;">
                        <h4 style="margin-bottom: 10px; color: #ffffff; font-size: 14px;">‚è∞ ÏãúÍ∞ÑÎåÄÎ≥Ñ</h4>
                        <input type="range" class="time-slider" id="daily-time-slider" min="0" max="780" value="0" step="1">
                        <div class="time-labels">
                            <span id="daily-date-display" style="color: #60a5fa; font-weight: 600;">2025-08-01</span>
                            <span id="daily-time-display">07:00</span>
                            <span id="daily-minute-display" style="display: none;">Î∂Ñ: 0 / 780</span>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- Ïö∞Ï∏° Ìå®ÎÑê: Î∂ÑÏÑù ÏÑ§Ï†ï ÌïòÍ∏∞ -->
        <div class="panel panel-right">
            <div class="panel-header">
                <span class="header-title">Energy Simulation</span>
                <div class="header-buttons" style="display: none;">
                    <button class="btn btn-dark" id="analyze-btn">
                        üî¨ Î∂ÑÏÑù ÌïòÍ∏∞ (ÏóêÎÑàÏßÄ ÏÇ¨Ïö©Îüâ)
                    </button>
                </div>
            </div>
            <div class="panel-content">
                <!-- Controller Îã§Ïù¥Ïñ¥Í∑∏Îû® -->
                <div class="controller-section">
                    <div class="diagram-image-container">
                        <!-- Tree Menu -->
                        <div class="tree-menu">
                            <div class="tree-menu-item expanded">
                                <div class="tree-menu-toggle">
                                    <span class="tree-menu-icon"></span>
                                    <span class="tree-menu-label">Building</span>
                                </div>
                                <div class="tree-menu-children">
                                    <div class="tree-menu-item expanded">
                                        <div class="tree-menu-toggle">
                                            <span class="tree-menu-icon"></span>
                                            <span class="tree-menu-label">Zone: REF_CELL</span>
                                        </div>
                                        <div class="tree-menu-children">
                                            <div class="tree-menu-item leaf">
                                                <div class="tree-menu-toggle">
                                                    <span class="tree-menu-icon"></span>
                                                    <span class="tree-menu-label">Heating</span>
                                                </div>
                                            </div>
                                            <div class="tree-menu-item leaf">
                                                <div class="tree-menu-toggle">
                                                    <span class="tree-menu-icon"></span>
                                                    <span class="tree-menu-label">Cooling</span>
                                                </div>
                                            </div>
                                            <div class="tree-menu-item leaf">
                                                <div class="tree-menu-toggle">
                                                    <span class="tree-menu-icon"></span>
                                                    <span class="tree-menu-label">Gain/loss</span>
                                                </div>
                                            </div>
                                            <div class="tree-menu-item leaf">
                                                <div class="tree-menu-toggle">
                                                    <span class="tree-menu-icon"></span>
                                                    <span class="tree-menu-label">Ventilation</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="tree-menu-item">
                                        <div class="tree-menu-toggle">
                                            <span class="tree-menu-icon"></span>
                                            <span class="tree-menu-label">Zone: TEST_CELL</span>
                                        </div>
                                        <div class="tree-menu-children">
                                            <div class="tree-menu-item leaf">
                                                <div class="tree-menu-toggle">
                                                    <span class="tree-menu-icon"></span>
                                                    <span class="tree-menu-label">Heating</span>
                                                </div>
                                            </div>
                                            <div class="tree-menu-item leaf">
                                                <div class="tree-menu-toggle">
                                                    <span class="tree-menu-icon"></span>
                                                    <span class="tree-menu-label">Cooling</span>
                                                </div>
                                            </div>
                                            <div class="tree-menu-item leaf">
                                                <div class="tree-menu-toggle">
                                                    <span class="tree-menu-icon"></span>
                                                    <span class="tree-menu-label">Gain/loss</span>
                                                </div>
                                            </div>
                                            <div class="tree-menu-item leaf">
                                                <div class="tree-menu-toggle">
                                                    <span class="tree-menu-icon"></span>
                                                    <span class="tree-menu-label">Ventilation</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tree-menu-item">
                                <div class="tree-menu-toggle">
                                    <span class="tree-menu-icon"></span>
                                    <span class="tree-menu-label">Schedule</span>
                                </div>
                            </div>
                        </div>
                        <img src="/img/tlab-project.png" alt="T-LAB ÌîÑÎ°úÏ†ùÌä∏ Îã§Ïù¥Ïñ¥Í∑∏Îû®" class="diagram-image" usemap="#zone-map">
                        <map name="zone-map" id="zone-map">
                            <!-- REF_CELL ÏòÅÏó≠ (Ï¢åÏ∏° ÏòÅÏó≠, Ï¢åÌëúÎäî Ïù¥ÎØ∏ÏßÄ ÌÅ¨Í∏∞Ïóê ÎßûÍ≤å Ï°∞Ï†ï ÌïÑÏöî) -->
                            <area shape="rect" coords="0,0,50%,100%" alt="Zone: REF_CELL" href="javascript:void(0);" data-zone="REF_CELL" class="zone-area">
                            <!-- TEST_CELL ÏòÅÏó≠ (Ïö∞Ï∏° ÏòÅÏó≠, Ï¢åÌëúÎäî Ïù¥ÎØ∏ÏßÄ ÌÅ¨Í∏∞Ïóê ÎßûÍ≤å Ï°∞Ï†ï ÌïÑÏöî) -->
                            <area shape="rect" coords="50%,0,100%,100%" alt="Zone: TEST_CELL" href="javascript:void(0);" data-zone="TEST_CELL" class="zone-area">
                        </map>
                    </div>
                </div>

                <!-- ÏãúÎÆ¨Î†àÏù¥ÏÖò ÏÑ§Ï†ï -->
                <div class="simulation-settings">
                    <h3>ÏãúÎÆ¨Î†àÏù¥ÏÖò ÏÑ§Ï†ï</h3>
                    <!-- ÌååÎùºÎØ∏ÌÑ∞ Ï†ïÎ≥¥ Î∞î -->
                    <div class="simulation-params-bar">
                        <span class="params-pin-icon">üìå</span>
                        <span>Time step: 1Î∂Ñ | ÎÉâÎ∞©: 8Ïõî~9Ïõî | ÎÇúÎ∞©: 1Ïõî~2Ïõî | Ï£ºÏ§ë Ïö¥Ï†Ñ</span>
                    </div>
                    <table class="settings-table">
                        <thead>
                            <tr>
                                <th style="width: 120px;">Zone</th>
                                <th style="width: 150px;">Í∏∞Í∏∞Î∞úÏó¥ [kJ/h¬∑m¬≤]</th>
                                <th style="width: 150px;">Ï°∞Î™ÖÎ∞úÏó¥ [kJ/h¬∑m¬≤]</th>
                                <th style="width: 150px;">Ïô∏Í∏∞ÎèÑÏûÖÎüâ [m¬≥/m¬≤¬∑h]</th>
                                <th style="width: 120px;">ÏÑ§Ï†ïÏò®ÎèÑ [¬∞C]</th>
                                <th style="width: 130px;">ÏÇ¨Ïö©ÏãúÍ∞Ñ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="cell-row-label" style="background-color: #1a1a1a;">REF_CELL</td>
                                <td>
                                    <div class="param-value" id="ref-equipment">50.4</div>
                                </td>
                                <td>
                                    <div class="param-value" id="ref-lighting">23.4</div>
                                </td>
                                <td>
                                    <div class="param-value" id="ref-ventilation">6</div>
                                </td>
                                <td>
                                    <div class="param-value" id="ref-temperature">26</div>
                                </td>
                                <td>
                                    <div class="param-value" id="ref-time-display">07:00-18:00</div>
                                </td>
                            </tr>
                            <tr>
                                <td class="cell-row-label" style="background-color: #1a1a1a;">TEST_CELL</td>
                                <td>
                                    <div class="param-value" id="test-equipment-display">50.4</div>
                                </td>
                                <td>
                                    <div class="param-value" id="test-lighting-display">23.4</div>
                                </td>
                                <td>
                                    <div class="param-value" id="test-ventilation-display">6</div>
                                </td>
                                <td>
                                    <div class="param-value" id="test-temperature-display">26</div>
                                </td>
                                <td>
                                    <div class="param-value" id="test-time-display">07:00-18:00</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- Î≤ÑÌäº ÏòÅÏó≠ (Ïò§Î•∏Ï™Ω ÌïòÎã®) -->
                    <div style="margin-top: 20px; display: flex; justify-content: flex-end; gap: 10px;">
                        <button class="btn btn-gray" id="analyze-energy-btn">
                            Î∂ÑÏÑùÌïòÍ∏∞ (ÏóêÎÑàÏßÄ ÏÇ¨Ïö©Îüâ)
                        </button>
                        <button class="btn btn-gray" id="send-control-signal-btn">
                            Ï†úÏñ¥Ïã†Ìò∏ ÏÜ°Ï∂ú
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- BIM Îç∞Ïù¥ÌÑ∞ Ï∂îÏ∂ú ÌåùÏóÖ -->
    <div class="bim-extract-popup-overlay" id="bim-extract-popup">
        <div class="bim-extract-popup">
            <div class="bim-extract-popup-header">Warning message</div>
            <div class="bim-extract-popup-content">
                <div class="bim-extract-popup-icon">!</div>
                <div class="bim-extract-popup-message" id="bim-extract-message">
                    BIM Îç∞Ïù¥ÌÑ∞Î•º Ï∂îÏ∂úÌïòÎäî Ï§ëÏûÖÎãàÎã§.
                </div>
            </div>
            <div class="bim-extract-progress">
                <div class="bim-extract-progress-step">
                    <div class="bim-extract-progress-circle" id="step-shape">V</div>
                    <div class="bim-extract-progress-label">ÌòïÏÉÅÏ†ïÎ≥¥</div>
                </div>
                <div class="bim-extract-progress-step">
                    <div class="bim-extract-progress-circle" id="step-passive"></div>
                    <div class="bim-extract-progress-label">Ìå®ÏãúÎ∏å ÏÜçÏÑ±</div>
                </div>
                <div class="bim-extract-progress-step">
                    <div class="bim-extract-progress-circle" id="step-active"></div>
                    <div class="bim-extract-progress-label">Ïï°Ìã∞Î∏å ÏÜçÏÑ±</div>
                </div>
            </div>
            <div class="bim-extract-popup-footer">
                <button class="bim-extract-popup-confirm-btn" id="bim-extract-confirm-btn" disabled>ÌôïÏù∏</button>
            </div>
        </div>
    </div>

    <!-- Ï†úÏñ¥Ïã†Ìò∏ ÏÜ°Ï∂ú Í≤ΩÍ≥† ÌåùÏóÖ -->
    <div class="bim-extract-popup-overlay" id="control-signal-popup">
        <div class="bim-extract-popup">
            <div class="bim-extract-popup-header">Warning message</div>
            <div class="bim-extract-popup-content">
                <div class="bim-extract-popup-icon">!</div>
                <div class="bim-extract-popup-message" style="line-height: 1.6;">
                    Ï†úÏñ¥Ïã†Ìò∏ ÏÜ°Ï∂úÏóê Ïã§Ìå®ÌïòÏòÄÏäµÎãàÎã§.
                </div>
            </div>
            <div class="bim-extract-popup-footer">
                <button class="bim-extract-popup-confirm-btn" id="control-signal-confirm-btn">ÌôïÏù∏</button>
            </div>
        </div>
    </div>

    <!-- ÏãúÎÆ¨Î†àÏù¥ÏÖò Îß§ÎãàÏ†Ä ÌåùÏóÖ -->
    <div class="simulation-manager-popup-overlay" id="simulation-manager-popup">
        <div class="simulation-manager-popup">
            <div class="simulation-manager-popup-header">
                <span class="simulation-manager-popup-title">"Simulation" Manager</span>
                <div class="simulation-manager-popup-buttons">
                    <button class="simulation-manager-popup-btn" id="simulation-manager-check-btn" title="ÌôïÏù∏">‚úì</button>
                    <button class="simulation-manager-popup-btn" id="simulation-manager-close-btn" title="Îã´Í∏∞">‚úï</button>
                </div>
            </div>
            <div class="simulation-manager-popup-content">
                <div class="simulation-manager-form-group">
                    <label class="simulation-manager-label">simulation:</label>
                    <select class="simulation-manager-select" id="simulation-manager-select">
                        <option value="select">Select</option>
                        <option value="heating">Heating energy consumption</option>
                        <option value="cooling">Cooling energy consumption</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <!-- Schedule ÌåùÏóÖ -->
    <div class="schedule-popup-overlay" id="schedule-popup">
        <div class="schedule-popup">
            <div class="schedule-popup-header">
                <div class="schedule-popup-icon">üìÖ</div>
                <span class="schedule-popup-title">Schedule</span>
                <div class="schedule-popup-buttons">
                    <button class="schedule-popup-btn" id="schedule-check-btn" title="ÌôïÏù∏">‚úì</button>
                    <button class="schedule-popup-btn" id="schedule-close-btn" title="Îã´Í∏∞">‚úï</button>
                </div>
            </div>
            <div class="schedule-popup-content">
                <!-- Zone: REF_CELL -->
                <div class="schedule-zone-section">
                    <div class="schedule-zone-title">Zone: REF_CELL</div>
                    <div class="schedule-form-group">
                        <label class="schedule-label">Hours of operation:</label>
                        <div class="schedule-select-wrapper">
                            <select class="schedule-select" id="schedule-ref-cell">
                                <option value="07-16">07:00-16:00</option>
                                <option value="07-18" selected>07:00-18:00 (default)</option>
                                <option value="07-20">07:00-20:00</option>
                            </select>
                            <span class="schedule-edit-icon" title="Ìé∏Ïßë">‚úèÔ∏è</span>
                        </div>
                    </div>
                </div>

                <div class="schedule-divider"></div>

                <!-- Zone: TEST_CELL -->
                <div class="schedule-zone-section">
                    <div class="schedule-zone-title">Zone: TEST_CELL</div>
                    <div class="schedule-form-group">
                        <label class="schedule-label">Hours of operation:</label>
                        <div class="schedule-select-wrapper">
                            <select class="schedule-select" id="schedule-test-cell">
                                <option value="07-16">07:00-16:00</option>
                                <option value="07-18" selected>07:00-18:00 (default)</option>
                                <option value="07-20">07:00-20:00</option>
                            </select>
                            <span class="schedule-edit-icon" title="Ìé∏Ïßë">‚úèÔ∏è</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Zone Ï†ïÎ≥¥ ÌåùÏóÖ -->
    <div class="zone-info-popup-overlay" id="zone-info-popup">
        <div class="zone-info-popup">
            <div class="zone-info-popup-header">
                <span class="zone-info-popup-title" id="zone-info-popup-title">Zone: REF_CELL</span>
                <div class="zone-info-popup-buttons">
                    <button class="zone-info-popup-btn" id="zone-info-check-btn" title="ÌôïÏù∏">‚úì</button>
                    <button class="zone-info-popup-btn" id="zone-info-close-btn" title="Îã´Í∏∞">‚úï</button>
                </div>
            </div>
            <div class="zone-info-popup-content">
                <div class="zone-info-section">
                    <div class="zone-info-field">
                        <span class="zone-info-field-label">volume:</span>
                        <div class="zone-info-field-value">
                            <input type="number" class="zone-info-field-input" id="zone-volume" value="151.20" step="0.01">
                            <span class="zone-info-field-unit">m¬≥</span>
                        </div>
                    </div>
                    <div class="zone-info-field">
                        <span class="zone-info-field-label">Capacitance:</span>
                        <div class="zone-info-field-value">
                            <input type="number" class="zone-info-field-input" id="zone-capacitance" value="181.44" step="0.01">
                            <span class="zone-info-field-unit">kJ/K</span>
                        </div>
                    </div>
                    <div class="zone-info-field">
                        <span class="zone-info-field-label">ref. floor area:</span>
                        <div class="zone-info-field-value">
                            <input type="number" class="zone-info-field-input" id="zone-floor-area" value="54.00" step="0.01">
                            <span class="zone-info-field-unit">m¬≤</span>
                        </div>
                    </div>
                </div>

                <div class="zone-info-menu-group">
                    <div class="zone-info-menu-title">Airnode Regime Data</div>
                    <div class="zone-info-menu-container">
                        <div class="zone-info-menu-left">
                            <div class="zone-info-menu-item disabled" data-type="heating" id="zone-menu-heating">
                                <div class="zone-info-menu-icon">
                                    <span class="icon-overlay icon-sun">‚òÄÔ∏è</span>
                                    <span class="icon-overlay icon-temp">üå°Ô∏è</span>
                                </div>
                                <span class="zone-info-menu-label">Heating</span>
                            </div>
                            <div class="zone-info-menu-item disabled" data-type="cooling" id="zone-menu-cooling">
                                <div class="zone-info-menu-icon">
                                    <span class="icon-overlay icon-snow">‚ùÑÔ∏è</span>
                                    <span class="icon-overlay icon-temp">üå°Ô∏è</span>
                                </div>
                                <span class="zone-info-menu-label">Cooling</span>
                            </div>
                        </div>
                        <div class="zone-info-menu-right">
                            <div class="zone-info-menu-item" data-type="gain" id="zone-menu-gain">
                                <div class="zone-info-menu-icon">üïØÔ∏è</div>
                                <span class="zone-info-menu-label">Gain/losses</span>
                            </div>
                            <div class="zone-info-menu-item" data-type="ventilation" id="zone-menu-ventilation">
                                <div class="zone-info-menu-icon">üí®</div>
                                <span class="zone-info-menu-label">Ventilation</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Heating Type Manager ÌåùÏóÖ -->
    <div class="type-manager-popup-overlay" id="heating-type-popup">
        <div class="type-manager-popup">
            <div class="type-manager-popup-header">
                <span class="type-manager-popup-icon">
                    <span class="icon-overlay icon-sun">‚òÄÔ∏è</span>
                <span class="icon-overlay icon-temp">üå°Ô∏è</span>
                </span>
                <span class="type-manager-popup-title">"Heating Type" Manager</span>
                <div class="type-manager-popup-buttons">
                    <button class="type-manager-popup-btn" id="heating-type-check-btn" title="ÌôïÏù∏">‚úì</button>
                    <button class="type-manager-popup-btn" id="heating-type-close-btn" title="Îã´Í∏∞">‚úï</button>
                </div>
            </div>
            <div class="type-manager-popup-content">
                <div class="type-manager-section-title">Room Temperature Control</div>
                <div class="type-manager-section-subtitle">Ïò®ÎèÑ ÏÑ§Ï†ïÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</div>
                <div class="type-manager-form-group">
                    <label class="type-manager-label">set temperature:</label>
                    <div class="type-manager-select-wrapper">
                        <select class="type-manager-select" id="heating-type-select">
                            <option value="select">Select</option>
                            <option value="18">18</option>
                            <option value="20" selected>20 (default)</option>
                            <option value="22">22</option>
                        </select>
                        <span class="type-manager-unit">¬∞C</span>
                        <span class="type-manager-edit-icon" title="Ìé∏Ïßë">‚úèÔ∏è</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cooling Type Manager ÌåùÏóÖ -->
    <div class="type-manager-popup-overlay" id="cooling-type-popup">
        <div class="type-manager-popup">
            <div class="type-manager-popup-header">
                <span class="type-manager-popup-icon">
                    <span class="icon-overlay icon-snow">‚ùÑÔ∏è</span>
                <span class="icon-overlay icon-temp">üå°Ô∏è</span>
                </span>
                <span class="type-manager-popup-title">"Cooling Type" Manager</span>
                <div class="type-manager-popup-buttons">
                    <button class="type-manager-popup-btn" id="cooling-type-check-btn" title="ÌôïÏù∏">‚úì</button>
                    <button class="type-manager-popup-btn" id="cooling-type-close-btn" title="Îã´Í∏∞">‚úï</button>
                </div>
            </div>
            <div class="type-manager-popup-content">
                <div class="type-manager-section-title">Room Temperature Control</div>
                <div class="type-manager-section-subtitle">Ïò®ÎèÑ ÏÑ§Ï†ïÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</div>
                <div class="type-manager-form-group">
                    <label class="type-manager-label">set temperature:</label>
                    <div class="type-manager-select-wrapper">
                        <select class="type-manager-select" id="cooling-type-select">
                            <option value="select">Select</option>
                            <option value="18">18</option>
                            <option value="20" selected>20 (default)</option>
                            <option value="22">22</option>
                        </select>
                        <span class="type-manager-unit">¬∞C</span>
                        <span class="type-manager-edit-icon" title="Ìé∏Ïßë">‚úèÔ∏è</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Gain/losses Type Manager ÌåùÏóÖ -->
    <div class="type-manager-popup-overlay" id="gain-type-popup">
        <div class="type-manager-popup">
            <div class="type-manager-popup-header">
                <span class="type-manager-popup-icon">üïØÔ∏è</span>
                <span class="type-manager-popup-title">"Gain/loss Type" Manager</span>
                <div class="type-manager-popup-buttons">
                    <button class="type-manager-popup-btn" id="gain-type-check-btn" title="ÌôïÏù∏">‚úì</button>
                    <button class="type-manager-popup-btn" id="gain-type-close-btn" title="Îã´Í∏∞">‚úï</button>
                </div>
            </div>
            <div class="type-manager-popup-content">
                <!-- electrical equipment ÏÑπÏÖò -->
                <div class="type-manager-subsection">
                    <div class="type-manager-section-title">electrical equipment</div>
                    <div class="type-manager-form-group">
                        <label class="type-manager-label">set gain/loss:</label>
                        <div class="type-manager-select-wrapper">
                            <select class="type-manager-select" id="gain-type-electrical-select">
                                <option value="select">Select</option>
                                <option value="35.3">35.3</option>
                                <option value="50.4" selected>50.4 (default)</option>
                                <option value="65.5">65.5</option>
                            </select>
                            <span class="type-manager-unit">kJ/h¬∑m¬≤</span>
                            <span class="type-manager-edit-icon" title="Ìé∏Ïßë">‚úèÔ∏è</span>
                        </div>
                    </div>
                </div>

                <!-- Íµ¨Î∂ÑÏÑ† -->
                <div class="type-manager-divider"></div>

                <!-- lights ÏÑπÏÖò -->
                <div class="type-manager-subsection">
                    <div class="type-manager-section-title">lights</div>
                    <div class="type-manager-form-group">
                        <label class="type-manager-label">set gain/loss:</label>
                        <div class="type-manager-select-wrapper">
                            <select class="type-manager-select" id="gain-type-lights-select">
                                <option value="select">Select</option>
                                <option value="16.4">16.4</option>
                                <option value="23.4" selected>23.4 (default)</option>
                                <option value="30.4">30.4</option>
                            </select>
                            <span class="type-manager-unit">kJ/h¬∑m¬≤</span>
                            <span class="type-manager-edit-icon" title="Ìé∏Ïßë">‚úèÔ∏è</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ventilation Type Manager ÌåùÏóÖ -->
    <div class="type-manager-popup-overlay" id="ventilation-type-popup">
        <div class="type-manager-popup">
            <div class="type-manager-popup-header">
                <span class="type-manager-popup-icon">üí®</span>
                <span class="type-manager-popup-title">"Ventilation Type" Manager</span>
                <div class="type-manager-popup-buttons">
                    <button class="type-manager-popup-btn" id="ventilation-type-check-btn" title="ÌôïÏù∏">‚úì</button>
                    <button class="type-manager-popup-btn" id="ventilation-type-close-btn" title="Îã´Í∏∞">‚úï</button>
                </div>
            </div>
            <div class="type-manager-popup-content">
                <div class="type-manager-section-title" style="border-bottom: 1px solid #555555; padding-bottom: 10px; margin-bottom: 15px;">Supply air flow</div>
                <div class="type-manager-form-group">
                    <label class="type-manager-label">Volume flow rate related to reference floor area:</label>
                    <div class="type-manager-select-wrapper">
                        <select class="type-manager-select" id="ventilation-type-select">
                            <option value="select">Select</option>
                            <option value="3">3</option>
                            <option value="6" selected>6 (default)</option>
                            <option value="9">9</option>
                        </select>
                        <span class="type-manager-unit">m¬≥/m¬≤¬∑h</span>
                        <span class="type-manager-edit-icon" title="Ìé∏Ïßë">‚úèÔ∏è</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script async src="https://unpkg.com/es-module-shims@1.8.2/dist/es-module-shims.js"></script>
    <script type="importmap">
        { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js", "three/": "https://unpkg.com/three@0.160.0/", "web-ifc": "/js/web-ifc-api.js" } }
    </script>
    <script type="module" src="/js/simulator-dark.js"></script>
    <script>
        // Ìó§Îçî Î≤ÑÌäº Ïù¥Î≤§Ìä∏ Ïó∞Í≤∞
        document.addEventListener('DOMContentLoaded', function() {
            // BIM Î∂àÎü¨Ïò§Í∏∞ Î≤ÑÌäº - ÌååÏùº Î∂àÎü¨Ïò§Í∏∞ Í∏∞Îä•
            const headerLoadBimBtn = document.getElementById('header-load-bim-btn');
            const loadIfcBtn = document.getElementById('load-ifc-btn');

            if (headerLoadBimBtn && loadIfcBtn) {
                headerLoadBimBtn.addEventListener('click', function() {
                    loadIfcBtn.click();
                });
            }

            // BIM Îç∞Ïù¥ÌÑ∞ Ï∂îÏ∂ú Î≤ÑÌäº - ÌåùÏóÖ ÌëúÏãú Î∞è ÏßÑÌñâ
            const headerExtractBimBtn = document.getElementById('header-extract-bim-btn');
            const bimExtractPopup = document.getElementById('bim-extract-popup');
            const bimExtractMessage = document.getElementById('bim-extract-message');
            const bimExtractConfirmBtn = document.getElementById('bim-extract-confirm-btn');
            const stepShape = document.getElementById('step-shape');
            const stepPassive = document.getElementById('step-passive');
            const stepActive = document.getElementById('step-active');

            if (headerExtractBimBtn && bimExtractPopup) {
                headerExtractBimBtn.addEventListener('click', function() {
                    // ÌåùÏóÖ ÌëúÏãú
                    bimExtractPopup.classList.add('show');

                    // Ï¥àÍ∏∞ ÏÉÅÌÉú ÏÑ§Ï†ï
                    bimExtractMessage.textContent = 'BIM Îç∞Ïù¥ÌÑ∞Î•º Ï∂îÏ∂úÌïòÎäî Ï§ëÏûÖÎãàÎã§.';
                    stepShape.classList.remove('completed');
                    stepPassive.classList.remove('completed');
                    stepActive.classList.remove('completed');
                    stepShape.textContent = 'V';
                    stepPassive.textContent = '';
                    stepActive.textContent = '';
                    bimExtractConfirmBtn.disabled = true;

                    // 1Îã®Í≥Ñ: ÌòïÏÉÅÏ†ïÎ≥¥ (Ï¶âÏãú Ï≤¥ÌÅ¨)
                    setTimeout(function() {
                        stepShape.classList.add('completed');
                        stepShape.textContent = '';
                    }, 500);

                    // 2Îã®Í≥Ñ: Ìå®ÏãúÎ∏å ÏÜçÏÑ± (1.5Ï¥à ÌõÑ)
                    setTimeout(function() {
                        bimExtractMessage.textContent = 'Ìå®ÏãúÎ∏å ÏÜçÏÑ±ÏùÑ Ï∂îÏ∂úÌïòÎäî Ï§ëÏûÖÎãàÎã§.';
                        stepPassive.classList.add('completed');
                        stepPassive.textContent = '';
                    }, 1500);

                    // 3Îã®Í≥Ñ: Ïï°Ìã∞Î∏å ÏÜçÏÑ± (3Ï¥à ÌõÑ)
                    setTimeout(function() {
                        bimExtractMessage.textContent = 'Ïï°Ìã∞Î∏å ÏÜçÏÑ±ÏùÑ Ï∂îÏ∂úÌïòÎäî Ï§ëÏûÖÎãàÎã§.';
                        stepActive.classList.add('completed');
                        stepActive.textContent = '';
                    }, 3000);

                    // ÏôÑÎ£å ÌõÑ ÌôïÏù∏ Î≤ÑÌäº ÌôúÏÑ±Ìôî (4.5Ï¥à ÌõÑ)
                    setTimeout(function() {
                        bimExtractConfirmBtn.disabled = false;
                    }, 4500);
                });
            }

            // ÌôïÏù∏ Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú ÌåùÏóÖ Îã´Í∏∞
            if (bimExtractConfirmBtn) {
                bimExtractConfirmBtn.addEventListener('click', function() {
                    bimExtractPopup.classList.remove('show');
                });
            }

            // ÏãúÎÆ¨Î†àÏù¥ÏÖò ÏÑ†ÌÉù Î≤ÑÌäº - ÌåùÏóÖ ÌëúÏãú
            const headerSelectSimBtn = document.getElementById('header-select-sim-btn');
            const simulationManagerPopup = document.getElementById('simulation-manager-popup');
            const simulationManagerSelect = document.getElementById('simulation-manager-select');
            const simulationManagerCheckBtn = document.getElementById('simulation-manager-check-btn');
            const simulationManagerCloseBtn = document.getElementById('simulation-manager-close-btn');
            const seasonButtons = document.querySelectorAll('.season-btn');

            if (headerSelectSimBtn && simulationManagerPopup) {
                headerSelectSimBtn.addEventListener('click', function() {
                    // ÌåùÏóÖ ÌëúÏãú
                    simulationManagerPopup.classList.add('show');
                    // ÎìúÎ°≠Îã§Ïö¥ Ï¥àÍ∏∞Ìôî
                    simulationManagerSelect.value = 'select';
                });
            }

            // Ï≤¥ÌÅ¨ Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú Ïó¨Î¶Ñ/Í≤®Ïö∏ ÏÑ†ÌÉù
            if (simulationManagerCheckBtn) {
                simulationManagerCheckBtn.addEventListener('click', function() {
                    const selectedValue = simulationManagerSelect.value;

                    if (selectedValue === 'select') {
                        // Select ÏÑ†ÌÉù Ïãú ÏïÑÎ¨¥Í≤ÉÎèÑ ÌïòÏßÄ ÏïäÏùå
                        simulationManagerPopup.classList.remove('show');
                        return;
                    }

                    // Heating energy consumption ‚Üí Í≤®Ïö∏ ÏÑ†ÌÉù
                    if (selectedValue === 'heating') {
                        seasonButtons.forEach(function(btn) {
                            if (btn.dataset.season === 'winter') {
                                btn.classList.add('active');
                                btn.click(); // ÏãúÎÆ¨Î†àÏù¥ÏÖò Î°úÏßÅÎèÑ Ìä∏Î¶¨Í±∞
                            } else {
                                btn.classList.remove('active');
                            }
                        });
                    }

                    // Cooling energy consumption ‚Üí Ïó¨Î¶Ñ ÏÑ†ÌÉù
                    if (selectedValue === 'cooling') {
                        seasonButtons.forEach(function(btn) {
                            if (btn.dataset.season === 'summer') {
                                btn.classList.add('active');
                                btn.click(); // ÏãúÎÆ¨Î†àÏù¥ÏÖò Î°úÏßÅÎèÑ Ìä∏Î¶¨Í±∞
                            } else {
                                btn.classList.remove('active');
                            }
                        });
                    }

                    // ÌåùÏóÖ Îã´Í∏∞
                    simulationManagerPopup.classList.remove('show');
                });
            }

            // Îã´Í∏∞ Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú ÌåùÏóÖ Îã´Í∏∞
            if (simulationManagerCloseBtn) {
                simulationManagerCloseBtn.addEventListener('click', function() {
                    simulationManagerPopup.classList.remove('show');
                });
            }

            // ÌåùÏóÖ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
            if (simulationManagerPopup) {
                simulationManagerPopup.addEventListener('click', function(e) {
                    if (e.target === simulationManagerPopup) {
                        simulationManagerPopup.classList.remove('show');
                    }
                });
            }

            // Tree Menu ÌôïÏû•/Ï∂ïÏÜå Í∏∞Îä•
            const treeMenuToggles = document.querySelectorAll('.tree-menu-toggle');
            treeMenuToggles.forEach(function(toggle) {
                toggle.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const menuItem = this.parentElement;
                    const label = this.querySelector('.tree-menu-label');

                    // Zone Ìï≠Î™© ÌÅ¥Î¶≠ Ïãú ÌåùÏóÖ ÌëúÏãú
                    if (label && (label.textContent.trim() === 'Zone: REF_CELL' || label.textContent.trim() === 'Zone: TEST_CELL')) {
                        const zoneInfoPopup = document.getElementById('zone-info-popup');
                        const zoneInfoTitle = document.getElementById('zone-info-popup-title');

                        if (zoneInfoPopup && zoneInfoTitle) {
                            // Zone Ïù¥Î¶Ñ ÏÑ§Ï†ï
                            let zoneName = label.textContent.trim();
                            zoneInfoTitle.textContent = zoneName;

                            // ÌòÑÏû¨ ÏÑ†ÌÉùÎêú Zone Ï∂îÏ†Å (Zone: REF_CELL ÎòêÎäî Zone: TEST_CELL ÌòïÏãùÏóêÏÑú REF_CELL ÎòêÎäî TEST_CELL Ï∂îÏ∂ú)
                            if (zoneName === 'Zone: REF_CELL') {
                                currentSelectedZone = 'REF_CELL';
                            } else if (zoneName === 'Zone: TEST_CELL') {
                                currentSelectedZone = 'TEST_CELL';
                            }

                            // ZoneÎ≥Ñ Ï¥àÍ∏∞Í∞í ÏÑ§Ï†ï
                            if (zoneName === 'Zone: REF_CELL') {
                                document.getElementById('zone-volume').value = '151.20';
                                document.getElementById('zone-capacitance').value = '181.44';
                                document.getElementById('zone-floor-area').value = '54.00';
                            } else if (zoneName === 'Zone: TEST_CELL') {
                                document.getElementById('zone-volume').value = '151.20';
                                document.getElementById('zone-capacitance').value = '181.44';
                                document.getElementById('zone-floor-area').value = '54.00';
                            }

                            // Î©îÎâ¥ ÏïÑÏù¥ÌÖú ÌôúÏÑ± ÏÉÅÌÉú Ï¥àÍ∏∞Ìôî
                            document.querySelectorAll('.zone-info-menu-item').forEach(function(item) {
                                item.classList.remove('active');
                            });

                            // Î™®Îì† Type Manager ÌåùÏóÖ Îã´Í∏∞
                            document.querySelectorAll('.type-manager-popup-overlay').forEach(function(popup) {
                                popup.classList.remove('show');
                            });

                            // ÌåùÏóÖ ÌëúÏãú
                            zoneInfoPopup.classList.add('show');
                        }
                        return;
                    }

                    // Schedule Ìï≠Î™© ÌÅ¥Î¶≠ Ïãú ÌåùÏóÖ ÌëúÏãú
                    if (label && label.textContent.trim() === 'Schedule') {
                        const schedulePopup = document.getElementById('schedule-popup');
                        if (schedulePopup) {
                            // ÌòÑÏû¨ ÏÑ§Ï†ïÎêú ÏãúÍ∞ÑÏùÑ ÌåùÏóÖÏóê Î∞òÏòÅ
                            const refTimeSelect = document.getElementById('ref-time');
                            const testTimeSelect = document.getElementById('test-time');
                            const scheduleRefCell = document.getElementById('schedule-ref-cell');
                            const scheduleTestCell = document.getElementById('schedule-test-cell');

                            if (refTimeSelect && scheduleRefCell) {
                                scheduleRefCell.value = refTimeSelect.value;
                            }
                            if (testTimeSelect && scheduleTestCell) {
                                scheduleTestCell.value = testTimeSelect.value;
                            }

                            schedulePopup.classList.add('show');
                        }
                        return;
                    }

                    // leaf Ìï≠Î™©Ïù¥ ÏïÑÎãå Í≤ΩÏö∞ÏóêÎßå ÌÜ†Í∏Ä
                    if (!menuItem.classList.contains('leaf')) {
                        menuItem.classList.toggle('expanded');
                    }
                });
            });

            // ÌòÑÏû¨ ÏÑ†ÌÉùÎêú Zone Ï∂îÏ†Å
            let currentSelectedZone = null; // 'REF_CELL' or 'TEST_CELL'

            // ÏãúÎÆ¨Î†àÏù¥ÏÖò ÏÑ§Ï†ï ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò
            function updateSimulationTable(zone, field, value) {
                if (zone === 'REF_CELL') {
                    const refFields = {
                        'equipment': 'ref-equipment',
                        'lighting': 'ref-lighting',
                        'ventilation': 'ref-ventilation',
                        'temperature': 'ref-temperature',
                        'time': 'ref-time-display'
                    };
                    const fieldId = refFields[field];
                    if (fieldId) {
                        const element = document.getElementById(fieldId);
                        if (element) {
                            element.textContent = value;
                        }
                    }
                } else if (zone === 'TEST_CELL') {
                    const testFields = {
                        'equipment': 'test-equipment-display',
                        'lighting': 'test-lighting-display',
                        'ventilation': 'test-ventilation-display',
                        'temperature': 'test-temperature-display',
                        'time': 'test-time-display'
                    };
                    const fieldId = testFields[field];
                    if (fieldId) {
                        const element = document.getElementById(fieldId);
                        if (element) {
                            element.textContent = value;
                        }
                    }
                }
            }

            // Zone Ï†ïÎ≥¥ ÌåùÏóÖ ÌëúÏãú Ìï®Ïàò (Ïû¨ÏÇ¨Ïö©)
            function showZoneInfoPopup(zoneName) {
                const zoneInfoPopup = document.getElementById('zone-info-popup');
                const zoneInfoTitle = document.getElementById('zone-info-popup-title');

                if (zoneInfoPopup && zoneInfoTitle) {
                    // Zone Ïù¥Î¶Ñ ÏÑ§Ï†ï Î∞è ÌòÑÏû¨ Zone Ï†ÄÏû•
                    zoneInfoTitle.textContent = 'Zone: ' + zoneName;
                    currentSelectedZone = zoneName; // 'REF_CELL' or 'TEST_CELL'

                    // ZoneÎ≥Ñ Ï¥àÍ∏∞Í∞í ÏÑ§Ï†ï
                    if (zoneName === 'REF_CELL') {
                        document.getElementById('zone-volume').value = '151.20';
                        document.getElementById('zone-capacitance').value = '181.44';
                        document.getElementById('zone-floor-area').value = '54.00';
                    } else if (zoneName === 'TEST_CELL') {
                        document.getElementById('zone-volume').value = '151.20';
                        document.getElementById('zone-capacitance').value = '181.44';
                        document.getElementById('zone-floor-area').value = '54.00';
                    }

                    // Î©îÎâ¥ ÏïÑÏù¥ÌÖú ÌôúÏÑ± ÏÉÅÌÉú Ï¥àÍ∏∞Ìôî
                    document.querySelectorAll('.zone-info-menu-item').forEach(function(item) {
                        item.classList.remove('active');
                    });

                    // Î™®Îì† Type Manager ÌåùÏóÖ Îã´Í∏∞
                    document.querySelectorAll('.type-manager-popup-overlay').forEach(function(popup) {
                        popup.classList.remove('show');
                    });

                    // ÌåùÏóÖ ÌëúÏãú
                    zoneInfoPopup.classList.add('show');
                }
            }

            // Ïù¥ÎØ∏ÏßÄÎßµ ÏòÅÏó≠ ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏ Ìï∏Îì§Îü¨
            const zoneAreas = document.querySelectorAll('map[name="zone-map"] area');
            zoneAreas.forEach(function(area) {
                area.addEventListener('click', function(e) {
                    e.preventDefault();
                    const zoneName = this.getAttribute('data-zone');
                    if (zoneName) {
                        showZoneInfoPopup(zoneName);
                    }
                });
            });

            // Schedule ÌåùÏóÖ Ïù¥Î≤§Ìä∏ Ìï∏Îì§Îü¨
            const schedulePopup = document.getElementById('schedule-popup');
            const scheduleCheckBtn = document.getElementById('schedule-check-btn');
            const scheduleCloseBtn = document.getElementById('schedule-close-btn');

            // ÌôïÏù∏ Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú ÏãúÎÆ¨Î†àÏù¥ÏÖò ÏÑ§Ï†ï ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
            if (scheduleCheckBtn) {
                scheduleCheckBtn.addEventListener('click', function() {
                    const scheduleRefCell = document.getElementById('schedule-ref-cell');
                    const scheduleTestCell = document.getElementById('schedule-test-cell');
                    const refTimeSelect = document.getElementById('ref-time');
                    const testTimeSelect = document.getElementById('test-time');

                    if (scheduleRefCell && refTimeSelect) {
                        refTimeSelect.value = scheduleRefCell.value;
                        // change Ïù¥Î≤§Ìä∏ Ìä∏Î¶¨Í±∞ÌïòÏó¨ Îã§Î•∏ Î°úÏßÅÎèÑ ÏóÖÎç∞Ïù¥Ìä∏
                        refTimeSelect.dispatchEvent(new Event('change'));
                    }

                    if (scheduleTestCell && testTimeSelect) {
                        testTimeSelect.value = scheduleTestCell.value;
                        // change Ïù¥Î≤§Ìä∏ Ìä∏Î¶¨Í±∞ÌïòÏó¨ Îã§Î•∏ Î°úÏßÅÎèÑ ÏóÖÎç∞Ïù¥Ìä∏
                        testTimeSelect.dispatchEvent(new Event('change'));
                    }

                    // ÌåùÏóÖ Îã´Í∏∞
                    if (schedulePopup) {
                        schedulePopup.classList.remove('show');
                    }
                });
            }

            // Îã´Í∏∞ Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú ÌåùÏóÖ Îã´Í∏∞
            if (scheduleCloseBtn) {
                scheduleCloseBtn.addEventListener('click', function() {
                    if (schedulePopup) {
                        schedulePopup.classList.remove('show');
                    }
                });
            }

            // ÌåùÏóÖ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
            if (schedulePopup) {
                schedulePopup.addEventListener('click', function(e) {
                    if (e.target === schedulePopup) {
                        schedulePopup.classList.remove('show');
                    }
                });
            }

            // Zone Ï†ïÎ≥¥ ÌåùÏóÖ Î©îÎâ¥ ÏïÑÏù¥ÌÖú ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            const zoneMenuItems = document.querySelectorAll('.zone-info-menu-item');
            const typeManagerPopups = {
                'heating': document.getElementById('heating-type-popup'),
                'cooling': document.getElementById('cooling-type-popup'),
                'gain': document.getElementById('gain-type-popup'),
                'ventilation': document.getElementById('ventilation-type-popup')
            };

            // ÌÜ†Í∏Ä ÌòïÏãù ÏïÑÏù¥ÌÖú (Heating, Cooling)
            const toggleItems = ['heating', 'cooling'];
            // ÌÅ¥Î¶≠ Ïãú ÌåùÏóÖ ÌëúÏãú ÏïÑÏù¥ÌÖú (Gain/losses, Ventilation)
            const popupItems = ['gain', 'ventilation'];

            // Heating, Cooling Ï¥àÍ∏∞ ÏÉÅÌÉú ÏÑ§Ï†ï (Îëò Îã§ disabledÏù∏ Í≤ΩÏö∞ HeatingÏùÑ Í∏∞Î≥∏ ÌôúÏÑ±Ìôî)
            const heatingItem = document.getElementById('zone-menu-heating');
            const coolingItem = document.getElementById('zone-menu-cooling');
            if (heatingItem && coolingItem) {
                const heatingDisabled = heatingItem.classList.contains('disabled');
                const coolingDisabled = coolingItem.classList.contains('disabled');

                // Îëò Îã§ disabledÏù∏ Í≤ΩÏö∞ HeatingÏùÑ Í∏∞Î≥∏ ÌôúÏÑ±Ìôî (ÌåùÏóÖÏùÄ ÌëúÏãúÌïòÏßÄ ÏïäÏùå)
                if (heatingDisabled && coolingDisabled) {
                    heatingItem.classList.remove('disabled');
                    heatingItem.classList.add('active');
                    // CoolingÏùÄ disabled ÏÉÅÌÉú Ïú†ÏßÄ (ÏÉÅÌò∏ Î∞∞ÌÉÄÏ†Å)
                    coolingItem.classList.add('disabled');
                    // Ï¥àÍ∏∞ ÏÉÅÌÉúÏóêÏÑúÎäî ÌåùÏóÖÏùÑ ÌëúÏãúÌïòÏßÄ ÏïäÏùå
                }
            }

            zoneMenuItems.forEach(function(menuItem) {
                menuItem.addEventListener('click', function() {
                    const type = this.dataset.type;
                    const targetPopup = typeManagerPopups[type];

                    // ÌÜ†Í∏Ä ÌòïÏãù ÏïÑÏù¥ÌÖú Ï≤òÎ¶¨ (Heating, Cooling) - ÏÉÅÌò∏ Î∞∞ÌÉÄÏ†Å ÎèôÏûë
                    if (toggleItems.includes(type)) {
                        // ÌòÑÏû¨ ÌÅ¥Î¶≠Ìïú ÏïÑÏù¥ÌÖúÏù¥ Ïù¥ÎØ∏ ÌôúÏÑ±ÌôîÎêòÏñ¥ ÏûàÏúºÎ©¥ ÏïÑÎ¨¥Í≤ÉÎèÑ ÌïòÏßÄ ÏïäÏùå
                        if (this.classList.contains('active')) {
                            return;
                        }

                        // ÌÅ¥Î¶≠Ìïú ÏïÑÏù¥ÌÖú ÌôúÏÑ±Ìôî
                        this.classList.remove('disabled');
                        this.classList.add('active');

                        // ÌôúÏÑ±Ìôî Ïãú ÌåùÏóÖ ÌëúÏãú
                        if (targetPopup) {
                            targetPopup.classList.add('show');
                        }

                        // Îã§Î•∏ ÌÜ†Í∏Ä ÏïÑÏù¥ÌÖú ÎπÑÌôúÏÑ±Ìôî
                        toggleItems.forEach(function(toggleType) {
                            if (toggleType !== type) {
                                const otherItem = document.getElementById('zone-menu-' + toggleType);
                                if (otherItem) {
                                    otherItem.classList.remove('active');
                                    otherItem.classList.add('disabled');
                                }
                                const otherPopup = typeManagerPopups[toggleType];
                                if (otherPopup) {
                                    otherPopup.classList.remove('show');
                                }
                            }
                        });
                    }
                    // ÌÅ¥Î¶≠ Ïãú ÌåùÏóÖ ÌëúÏãú ÏïÑÏù¥ÌÖú Ï≤òÎ¶¨ (Gain/losses, Ventilation)
                    else if (popupItems.includes(type)) {
                        // disabled ÏÉÅÌÉúÏùò ÏïÑÏù¥ÌÖúÏùÄ ÌÅ¥Î¶≠ Î∂àÍ∞Ä
                        if (this.classList.contains('disabled')) {
                            return;
                        }
                        // Îã§Î•∏ Î©îÎâ¥ ÏïÑÏù¥ÌÖúÏùò ÌôúÏÑ± ÏÉÅÌÉú Ï†úÍ±∞ (Í∞ôÏùÄ ÌÉÄÏûÖÎßå)
                        popupItems.forEach(function(popupType) {
                            if (popupType !== type) {
                                const otherItem = document.getElementById('zone-menu-' + popupType);
                                if (otherItem) {
                                    otherItem.classList.remove('active');
                                }
                                const otherPopup = typeManagerPopups[popupType];
                                if (otherPopup) {
                                    otherPopup.classList.remove('show');
                                }
                            }
                        });

                        // ÌòÑÏû¨ Î©îÎâ¥ ÏïÑÏù¥ÌÖú ÌÜ†Í∏Ä Î∞è ÌåùÏóÖ ÌëúÏãú
                        if (this.classList.contains('active')) {
                            // Ïù¥ÎØ∏ ÌôúÏÑ±ÌôîÎêòÏñ¥ ÏûàÏúºÎ©¥ Îã´Í∏∞
                            this.classList.remove('active');
                            if (targetPopup) {
                                targetPopup.classList.remove('show');
                            }
                        } else {
                            // ÌôúÏÑ±Ìôî Î∞è ÌåùÏóÖ ÌëúÏãú
                            this.classList.add('active');
                            if (targetPopup) {
                                targetPopup.classList.add('show');
                            }
                        }
                    }
                });
            });

            // Zone Ï†ïÎ≥¥ ÌåùÏóÖ Ïù¥Î≤§Ìä∏ Ìï∏Îì§Îü¨
            const zoneInfoPopup = document.getElementById('zone-info-popup');
            const zoneInfoCheckBtn = document.getElementById('zone-info-check-btn');
            const zoneInfoCloseBtn = document.getElementById('zone-info-close-btn');

            // Zone Ï†ïÎ≥¥ ÌåùÏóÖ ÌôïÏù∏ Î≤ÑÌäº
            if (zoneInfoCheckBtn) {
                zoneInfoCheckBtn.addEventListener('click', function() {
                    if (zoneInfoPopup) {
                        zoneInfoPopup.classList.remove('show');
                    }
                    // Î™®Îì† Type Manager ÌåùÏóÖÎèÑ Îã´Í∏∞
                    Object.values(typeManagerPopups).forEach(function(popup) {
                        if (popup) {
                            popup.classList.remove('show');
                        }
                    });
                    // Î©îÎâ¥ ÏïÑÏù¥ÌÖú ÌôúÏÑ± ÏÉÅÌÉú Ï†úÍ±∞
                    zoneMenuItems.forEach(function(item) {
                        item.classList.remove('active');
                    });
                });
            }

            // Zone Ï†ïÎ≥¥ ÌåùÏóÖ Îã´Í∏∞ Î≤ÑÌäº
            if (zoneInfoCloseBtn) {
                zoneInfoCloseBtn.addEventListener('click', function() {
                    if (zoneInfoPopup) {
                        zoneInfoPopup.classList.remove('show');
                    }
                    // Î™®Îì† Type Manager ÌåùÏóÖÎèÑ Îã´Í∏∞
                    Object.values(typeManagerPopups).forEach(function(popup) {
                        if (popup) {
                            popup.classList.remove('show');
                        }
                    });
                    // Î©îÎâ¥ ÏïÑÏù¥ÌÖú ÌôúÏÑ± ÏÉÅÌÉú Ï†úÍ±∞
                    zoneMenuItems.forEach(function(item) {
                        item.classList.remove('active');
                    });
                });
            }

            // Zone Ï†ïÎ≥¥ ÌåùÏóÖ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
            if (zoneInfoPopup) {
                zoneInfoPopup.addEventListener('click', function(e) {
                    if (e.target === zoneInfoPopup) {
                        zoneInfoPopup.classList.remove('show');
                        // Î™®Îì† Type Manager ÌåùÏóÖÎèÑ Îã´Í∏∞
                        Object.values(typeManagerPopups).forEach(function(popup) {
                            if (popup) {
                                popup.classList.remove('show');
                            }
                        });
                        // Î©îÎâ¥ ÏïÑÏù¥ÌÖú ÌôúÏÑ± ÏÉÅÌÉú Ï†úÍ±∞
                        zoneMenuItems.forEach(function(item) {
                            item.classList.remove('active');
                        });
                    }
                });
            }

            // Type Manager ÌåùÏóÖ Ïù¥Î≤§Ìä∏ Ìï∏Îì§Îü¨ (Í≥µÌÜµ)
            function setupTypeManagerPopup(popupId, checkBtnId, closeBtnId, selectId, menuItemId) {
                const popup = document.getElementById(popupId);
                const checkBtn = document.getElementById(checkBtnId);
                const closeBtn = document.getElementById(closeBtnId);
                const select = document.getElementById(selectId);
                const menuItem = document.getElementById(menuItemId);

                if (checkBtn) {
                    checkBtn.addEventListener('click', function() {
                        if (select) {
                            const selectedValue = select.value;
                            // ÏÑ§Ï†ï Ï†ÅÏö© Î°úÏßÅ Ï∂îÍ∞Ä Í∞ÄÎä•
                            console.log(`${popupId} ÏÑ§Ï†ï Ï†ÅÏö©:`, selectedValue);
                        }
                        if (popup) {
                            popup.classList.remove('show');
                        }
                        if (menuItem) {
                            menuItem.classList.remove('active');
                        }
                    });
                }

                if (closeBtn) {
                    closeBtn.addEventListener('click', function() {
                        if (popup) {
                            popup.classList.remove('show');
                        }
                        if (menuItem) {
                            menuItem.classList.remove('active');
                        }
                    });
                }

                // ÌåùÏóÖ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
                if (popup) {
                    popup.addEventListener('click', function(e) {
                        if (e.target === popup) {
                            popup.classList.remove('show');
                            if (menuItem) {
                                menuItem.classList.remove('active');
                            }
                        }
                    });
                }
            }

            // Heating Type Manager ÌåùÏóÖ ÌôïÏù∏ Î≤ÑÌäº
            const heatingCheckBtn = document.getElementById('heating-type-check-btn');
            const heatingSelect = document.getElementById('heating-type-select');
            const heatingPopup = document.getElementById('heating-type-popup');
            const heatingMenuItem = document.getElementById('zone-menu-heating');
            const heatingCloseBtn = document.getElementById('heating-type-close-btn');

            if (heatingCheckBtn) {
                heatingCheckBtn.addEventListener('click', function() {
                    if (currentSelectedZone && heatingSelect && heatingSelect.value !== 'select') {
                        updateSimulationTable(currentSelectedZone, 'temperature', heatingSelect.value);
                    }
                    if (heatingPopup) {
                        heatingPopup.classList.remove('show');
                    }
                    if (heatingMenuItem) {
                        heatingMenuItem.classList.remove('active');
                    }
                });
            }

            if (heatingCloseBtn) {
                heatingCloseBtn.addEventListener('click', function() {
                    if (heatingPopup) {
                        heatingPopup.classList.remove('show');
                    }
                    if (heatingMenuItem) {
                        heatingMenuItem.classList.remove('active');
                    }
                });
            }

            if (heatingPopup) {
                heatingPopup.addEventListener('click', function(e) {
                    if (e.target === heatingPopup) {
                        heatingPopup.classList.remove('show');
                        if (heatingMenuItem) {
                            heatingMenuItem.classList.remove('active');
                        }
                    }
                });
            }

            // Cooling Type Manager ÌåùÏóÖ ÌôïÏù∏ Î≤ÑÌäº
            const coolingCheckBtn = document.getElementById('cooling-type-check-btn');
            const coolingSelect = document.getElementById('cooling-type-select');
            const coolingPopup = document.getElementById('cooling-type-popup');
            const coolingMenuItem = document.getElementById('zone-menu-cooling');
            const coolingCloseBtn = document.getElementById('cooling-type-close-btn');

            if (coolingCheckBtn) {
                coolingCheckBtn.addEventListener('click', function() {
                    if (currentSelectedZone && coolingSelect && coolingSelect.value !== 'select') {
                        updateSimulationTable(currentSelectedZone, 'temperature', coolingSelect.value);
                    }
                    if (coolingPopup) {
                        coolingPopup.classList.remove('show');
                    }
                    if (coolingMenuItem) {
                        coolingMenuItem.classList.remove('active');
                    }
                });
            }

            if (coolingCloseBtn) {
                coolingCloseBtn.addEventListener('click', function() {
                    if (coolingPopup) {
                        coolingPopup.classList.remove('show');
                    }
                    if (coolingMenuItem) {
                        coolingMenuItem.classList.remove('active');
                    }
                });
            }

            if (coolingPopup) {
                coolingPopup.addEventListener('click', function(e) {
                    if (e.target === coolingPopup) {
                        coolingPopup.classList.remove('show');
                        if (coolingMenuItem) {
                            coolingMenuItem.classList.remove('active');
                        }
                    }
                });
            }

            // Gain/loss Type Manager ÌåùÏóÖ ÏÑ§Ï†ï (Îëê Í∞úÏùò select Ï≤òÎ¶¨)
            const gainPopup = document.getElementById('gain-type-popup');
            const gainCheckBtn = document.getElementById('gain-type-check-btn');
            const gainCloseBtn = document.getElementById('gain-type-close-btn');
            const gainElectricalSelect = document.getElementById('gain-type-electrical-select');
            const gainLightsSelect = document.getElementById('gain-type-lights-select');
            const gainMenuItem = document.getElementById('zone-menu-gain');

            if (gainCheckBtn) {
                gainCheckBtn.addEventListener('click', function() {
                    if (currentSelectedZone && gainElectricalSelect && gainLightsSelect) {
                        const electricalValue = gainElectricalSelect.value;
                        const lightsValue = gainLightsSelect.value;
                        if (electricalValue !== 'select') {
                            updateSimulationTable(currentSelectedZone, 'equipment', electricalValue);
                        }
                        if (lightsValue !== 'select') {
                            updateSimulationTable(currentSelectedZone, 'lighting', lightsValue);
                        }
                        console.log('Gain/loss Type ÏÑ§Ï†ï Ï†ÅÏö©:', {
                            electrical: electricalValue,
                            lights: lightsValue
                        });
                    }
                    if (gainPopup) {
                        gainPopup.classList.remove('show');
                    }
                    if (gainMenuItem) {
                        gainMenuItem.classList.remove('active');
                    }
                });
            }

            if (gainCloseBtn) {
                gainCloseBtn.addEventListener('click', function() {
                    if (gainPopup) {
                        gainPopup.classList.remove('show');
                    }
                    if (gainMenuItem) {
                        gainMenuItem.classList.remove('active');
                    }
                });
            }

            if (gainPopup) {
                gainPopup.addEventListener('click', function(e) {
                    if (e.target === gainPopup) {
                        gainPopup.classList.remove('show');
                        if (gainMenuItem) {
                            gainMenuItem.classList.remove('active');
                        }
                    }
                });
            }

            // Ventilation Type Manager ÌåùÏóÖ ÌôïÏù∏ Î≤ÑÌäº
            const ventilationCheckBtn = document.getElementById('ventilation-type-check-btn');
            const ventilationSelect = document.getElementById('ventilation-type-select');
            const ventilationPopup = document.getElementById('ventilation-type-popup');
            const ventilationMenuItem = document.getElementById('zone-menu-ventilation');
            const ventilationCloseBtn = document.getElementById('ventilation-type-close-btn');

            if (ventilationCheckBtn) {
                ventilationCheckBtn.addEventListener('click', function() {
                    if (currentSelectedZone && ventilationSelect && ventilationSelect.value !== 'select') {
                        updateSimulationTable(currentSelectedZone, 'ventilation', ventilationSelect.value);
                    }
                    if (ventilationPopup) {
                        ventilationPopup.classList.remove('show');
                    }
                    if (ventilationMenuItem) {
                        ventilationMenuItem.classList.remove('active');
                    }
                });
            }

            if (ventilationCloseBtn) {
                ventilationCloseBtn.addEventListener('click', function() {
                    if (ventilationPopup) {
                        ventilationPopup.classList.remove('show');
                    }
                    if (ventilationMenuItem) {
                        ventilationMenuItem.classList.remove('active');
                    }
                });
            }

            if (ventilationPopup) {
                ventilationPopup.addEventListener('click', function(e) {
                    if (e.target === ventilationPopup) {
                        ventilationPopup.classList.remove('show');
                        if (ventilationMenuItem) {
                            ventilationMenuItem.classList.remove('active');
                        }
                    }
                });
            }

            // Î∂ÑÏÑùÌïòÍ∏∞ (ÏóêÎÑàÏßÄ ÏÇ¨Ïö©Îüâ) Î≤ÑÌäº - Ïû¨ÏÉù Î≤ÑÌäº ÌÅ¥Î¶≠ Ìö®Í≥º
            const analyzeEnergyBtn = document.getElementById('analyze-energy-btn');
            const playBtn = document.getElementById('play-btn');
            if (analyzeEnergyBtn && playBtn) {
                analyzeEnergyBtn.addEventListener('click', function() {
                    playBtn.click();
                });
            }

            // Ï†úÏñ¥Ïã†Ìò∏ ÏÜ°Ï∂ú Î≤ÑÌäº - Í≤ΩÍ≥† ÌåùÏóÖ ÌëúÏãú
            const sendControlSignalBtn = document.getElementById('send-control-signal-btn');
            const controlSignalPopup = document.getElementById('control-signal-popup');
            const controlSignalConfirmBtn = document.getElementById('control-signal-confirm-btn');

            if (sendControlSignalBtn && controlSignalPopup) {
                sendControlSignalBtn.addEventListener('click', function() {
                    controlSignalPopup.classList.add('show');
                });
            }

            // ÌôïÏù∏ Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú ÌåùÏóÖ Îã´Í∏∞
            if (controlSignalConfirmBtn && controlSignalPopup) {
                controlSignalConfirmBtn.addEventListener('click', function() {
                    controlSignalPopup.classList.remove('show');
                });
            }

            // ÌåùÏóÖ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
            if (controlSignalPopup) {
                controlSignalPopup.addEventListener('click', function(e) {
                    if (e.target === controlSignalPopup) {
                        controlSignalPopup.classList.remove('show');
                    }
                });
            }
        });
    </script>
</body>

</html>

</html>